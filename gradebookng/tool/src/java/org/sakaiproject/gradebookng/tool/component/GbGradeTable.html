<html>
    <wicket:panel xmlns:wicket="http://wicket.apache.org">
        <div id="gradeTableWrapper">
            <div id="gradeTableSummary">
                <div class="gb-student-summary pull-left"></div>
                <div class="gb-grade-item-summary pull-right"></div>
            </div>
    
            <div wicket:id="gradeTable" id="gradeTable" accesskey="g" wicket:message="aria-label:gradetable.wrapper.tooltip" aria-describedby="gradeTableCaption"></div>
        </div>

        <script id="courseGradeHeaderTemplate" type="text/template">
            <span class="colHeader hide">${col}</span>
            <div class="relative">
                <a class="gb-title">
                    <wicket:message key="column.header.coursegrade"/>
                </a>
                <div class="btn-group">
                    <a class="btn btn-sm btn-default dropdown-toggle"
                       data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                       tabindex="-1">
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                        <li><a href="javascript:void(0);" class="gb-set-zero-score" role="menuitem"><wicket:message key="coursegrade.option.setungraded" /></a></li>
                        <li><a href="javascript:void(0);" class="gb-toggle-points" role="menuitem"><wicket:message key="coursegrade.option.togglepoints" /></a></li>
                    </ul>
                </div>
            </div>
        </script>
        <script id="assignmentHeaderTemplate" type="text/template">
            <span class="colHeader hide">${col}</span>
            <div class="relative">
                <a class="gb-title">
                    {if extraCredit}
                        <span class="gb-flag-extra-credit" wicket:message="title:label.gradeitem.extracredit"></span>
                    {/if}
                    ${title}
                </a>
                {if settings.isCategoriesEnabled}
                    {if categoryId}
                        <div class="gb-category">
                            <wicket:message key="label.category"/>
                            {if categoryExtraCredit}
                                <span class="gb-flag-extra-credit" wicket:message="title:label.gradeitem.extracreditcategory"></span>
                            {/if}
                            <span class="swatch" style="background-color: #${categoryColor}"></span>
                            <span>${categoryName}</span>
                            {if settings.isCategoryTypeWeighted}
                                <span class="gb-category-weight">[${categoryWeight}]</span>
                            {/if}
                        </div>
                    {else}
                        <div class="gb-uncategorized">
                            <wicket:message key="gradebookpage.uncategorised"/>
                        </div>
                    {/if}
                {/if}
                <div class="gb-grade-section">
                    {if settings.isPercentageGradeEntry}
                        <wicket:message key="label.relativeweight"/>
                    {else}
                        <wicket:message key="label.total"/>
                    {/if}
                    <span class="gb-total-points">
                        ${points}
                    </span>
                </div>
                <div class="gb-due-date">
                    <wicket:message key="label.due"/> 
                    <span>${dueDate}</span>
                </div>
                {if externallyMaintained}
                    <div class="gb-due-date">
                        <wicket:message key="label.external"/> 
                        <span>${externalAppName}</span>
                    </div>
                {/if}
                <div class="gb-grade-item-flags">
                    <!-- TODO popover -->
                    {if released}
                        <span class="gb-flag-released" wicket:message="title:label.gradeitem.released"></span>
                    {else}
                        <span class="gb-flag-not-released" wicket:message="title:label.gradeitem.notreleased"></span>
                    {/if}
                    {if includedInCourseGrade}
                        <span class="gb-flag-counted" wicket:message="title:label.gradeitem.counted"></span>
                    {else}
                        <span class="gb-flag-not-counted" wicket:message="title:label.gradeitem.notcounted"></span>
                    {/if}
                </div>
                <div class="btn-group">
                    <a class="btn btn-sm btn-default dropdown-toggle"
                       data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                       tabindex="-1">
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                        <li><a href="javascript:void(0);" class="edit-assignment-details" role="menuitem"><wicket:message key="assignment.option.edit" /></a></li>
                        <li><a href="javascript:void(0);" class="gb-view-statistics" role="menuitem"><wicket:message key="assignment.option.viewgradestatistics" /></a></li>
                        {if !externallyMaintained}
                            <li><a href="javascript:void(0);" class="gb-set-ungraded" role="menuitem"><wicket:message key="assignment.option.setungraded" /></a></li>
                            <li><a href="javascript:void(0);" class="gb-delete-item" role="menuitem"><span class="text-danger"><wicket:message key="delete.label" /></span></a></li>
                        {/if}
                    </ul>
                </div>
            </div>
        </script>
        <script id="categoryScoreHeaderTemplate" type="text/template">
            <span class="colHeader hide">${col}</span>
            <div class="relative">
                <a class="gb-title">
                    <span class="gb-category">
                        {if extraCredit}
                            <span class="gb-flag-extra-credit" wicket:message="title:label.gradeitem.extracredit"></span>
                        {/if}
                        <span class="swatch" style="background-color: #${color}"></span>
                        ${title}
                        {if settings.isCategoryTypeWeighted}
                            <span class="gb-category-weight" wicket:message="title:label.gradeitem.categoryweight">[${weight}]</span>
                        {/if}
                    </span>
                </a>
            </div>
        </script>
        <script id="studentHeaderTemplate" type="text/template">
            <div class="relative">
                <div class="colHeader">
                    <a class="gb-title">
                        <wicket:message key="column.header.students"/>
                    </a>
                    <div class="btn-group">
                        <a class="btn btn-sm btn-default dropdown-toggle"
                           data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                           wicket:message="title:grade.menulabel" tabindex="-1">
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-right" role="menu">
                            {if !settings.isStudentOrderedByLastName}
                                <li><a class="gb-student-name-order-toggle" data-order-by="last_name" href="#"><wicket:message key="sortbyname.option.last"/></a></li>
                            {/if}
                            {if !settings.isStudentOrderedByFirstName}
                                <li><a class="gb-student-name-order-toggle" data-order-by="first_name" href="#"><wicket:message key="sortbyname.option.first"/></a></li>
                            {/if}
                        </ul>
                    </div>
                </div>
            </div>
        </script>
        <script id="cellTemplate" type="text/template">
            <div class="relative">
                <span class="gb-value">${value}</span>
                <span class="gb-notification"></span>
                <span class="gb-comment-notification"></span>
                <div class="btn-group">
                    <a class="btn btn-sm btn-default dropdown-toggle"
                       data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                       wicket:message="title:grade.menulabel" tabindex="-1">
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                        <li><a class="gb-view-log" href="#" role="menuitem"><wicket:message key="grade.option.viewlog" /></a></li>
                        <li><a class="gb-edit-comments" href="#" role="menuitem"><wicket:message key="comment.option.edit" /></a></li>
                    </ul>
                </div>
            </div>
        </script>
        <script id="courseGradeCellTemplate" type="text/template">
            <div class="relative">
                <span class="gb-value">
                    ${value}
                </span>
                <div class="btn-group">
                    <a class="btn btn-sm btn-default dropdown-toggle"
                       data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                       tabindex="-1">
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                        <li><a href="javascript:void(0);" class="gb-course-grade-override" role="menuitem"><wicket:message key="coursegrade.option.override"/></a></li>
                        <li><a href="javascript:void(0);" class="gb-course-grade-override-log" role="menuitem"><wicket:message key="coursegrade.option.overridelog"/></a></li>
                    </ul>
                </div>
            </div>
        </script>
        <script id="studentCellTemplate" type="text/template">
            <div class="relative">
                <div class="gb-value">
                    <div class="rowHeader">
                        {if settings.isStudentOrderedByLastName}
                            <span class="gb-last-name">${lastName}</span>,
                            <span class="gb-first-name">${firstName}</span>
                            (<span class="gb-eid">${eid}</span>)
                        {else}
                            <span class="gb-first-name">${firstName}</span>
                            <span class="gb-last-name">${lastName}</span>
                            (<span class="gb-eid">${eid}</span>)
                        {/if}
                    </div>
                </div>
                <div class="btn-group">
                    <a class="btn btn-sm btn-default dropdown-toggle"
                       data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                       tabindex="-1">
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                        <li><a href="javascript:void(0);" class="gb-view-grade-summary" role="menuitem"><wicket:message key="label.studentsummary.instructorviewtab" /></a></li>
                    </ul>
                </div>
            </div>
        </script>
        <script id="metadataTemplate" type="text/template">
            <div id="${id}" class="gb-metadata">
                <a href="javascript:void(0);" class="gb-metadata-close"></a>
                <div class="gb-metadata-summary">
                    <h4 class="sr-only"><wicket:message key="metadata.header" /></h4>
                    <dl class="sr-only dl-horizontal">
                        <dt><wicket:message key="metadata.student" /></dt>
                        <dd>${student.lastName}, ${student.firstName} (${student.eid})</dd>
                        {if defined('assignment')}
                        <dt><wicket:message key="metadata.assignment" /></dt>
                        <dd>${assignment.title}</dd>
                        {/if}
                        {if defined('value')}
                        <dt><wicket:message key="metadata.score" /></dt>
                        <dd>${value}</dd>
                        {/if}
                        {if defined('courseGrade')}
                        <dt><wicket:message key="metadata.courseGrade" /></dt>
                        <dd>${courseGrade}</dd>
                        {/if}
                        {if defined('category')}
                        <dt><wicket:message key="metadata.category" /></dt>
                        <dd>${category.title}</dd>
                        {/if}
                        {if defined('categoryAverage')}
                        <dt><wicket:message key="metadata.categoryAverage" /></dt>
                        <dd>${categoryAverage}</dd>
                        {/if}
                    </dl>
                </div>
                <div class="gb-metadata-notifications">
                    {if defined('notifications') && notifications.length > 0}
                        <p class="sr-only"><wicket:message key="metadata.flags" /></p>
                        <ul>
                            {for notification in notifications}
                                {if notification.type == 'comment'}
                                    <li class="gb-metadata-comment-notification">
                                        <span class="gb-flag-comment"></span> <wicket:message key="grade.notifications.hascomment"/>
                                        <blockquote><wicket:message key="grade.notifications.commentloading"/></blockquote>
                                    </li>
                                {elseif notification.type == 'extra-credit'}
                                    <li>
                                        <span class="gb-flag-extra-credit"></span> <wicket:message key="grade.notifications.overlimit"/>
                                    </li>
                                {elseif notification.type == 'save-error'}
                                    <li>
                                        <span class="gb-flag-save-error"></span> <wicket:message key="grade.notifications.haserror"/>
                                    </li>
                                    <li>
                                        <span class="gb-flag-save-invalid"></span> <wicket:message key="grade.notifications.invalid"/>
                                    </li>
                                {elseif notification.type == 'save-invalid'}
                                    <li>
                                        <span class="gb-flag-save-invalid"></span> <wicket:message key="grade.notifications.invalid"/>
                                    </li>
                                {elseif notification.type == 'concurrent-edit'}
                                    <li>
                                        <span class="gb-flag-concurrent-edit"></span> <wicket:message key="grade.notifications.concurrentedit"/>
                                        <pre>${JSON.stringify(notification.conflict)}</pre>
                                    </li>
                                {elseif notification.type == 'external'}
                                    <li>
                                        <span class="gb-flag-read-only"></span> <wicket:message key="grade.notifications.readonly"/>
                                    </li>
                                    <li>
                                        <span class="gb-flag-external"></span> <wicket:message key="grade.notifications.isexternal"/>
                                    </li>
                                {elseif notification.type == 'readonly'}
                                    <li>
                                        <span class="gb-flag-read-only"></span> <wicket:message key="grade.notifications.readonly"/>
                                    </li>
                                    <li>
                                        <span class="gb-flag-read-only"></span> <wicket:message key="grade.notifications.privileges"/>
                                    </li>
                                {else}
                                    <li>
                                        <span class="gb-flag-${notification.type}"></span> ${notification.type}
                                    </li>
                                {/if}
                            {/for}
                        </ul>
                    {else}
                        <p><wicket:message key="metadata.noflags"/></p>
                    {/if}
                </div>
            </div>
        </script>
        <script id="studentSummaryTemplate" type="text/template">
            <wicket:message key="label.toolbar.studentsummary"/>
        </script>
        <script id="gradeItemSummaryTemplate" type="text/template">
            <wicket:message key="label.toolbar.gradeitemsummary"/>
        </script>
        <script id="captionTemplate" type="text/template">
            <caption id="gradeTableCaption">
                <div class="container-fluid">
                    <div class="sr-only row">
                        <h4><wicket:message key="gradetable.caption.summaryheader"/></h4>
                        <p><wicket:message key="gradetable.caption.summary"/></p>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <h4><wicket:message key="gradetable.caption.keyboardnavigationheader"/></h4>
                            <wicket:message key="gradetable.caption.keyboardnavigation"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <h4><wicket:message key="gradetable.caption.keyboardshortcutsheader"/></h4>
                            <wicket:message key="gradetable.caption.keyboardshortcuts"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-5">
                            <wicket:message key="gradetable.caption.keyboardtablemodeshortcuts"/>
                        </div>
                        <div class="col-sm-5">
                            <wicket:message key="gradetable.caption.keyboardeditingshortcuts"/>
                        </div>
                    </div>
                </div>
            </caption>
        </script>
    </wicket:panel>
</html>
